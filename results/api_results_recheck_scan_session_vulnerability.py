from base import BASE_URL
from .api_results_mixin import ApiResultsMixin
from .utils import VulnerabilityRecheck


class ApiRechechScanSessionVulnerabilityResults(ApiResultsMixin):
    def __init__(
            self,
            api_key: str,
            vulnerability_recheck: VulnerabilityRecheck,
            /,
            scan_id: str,
            result_id: str,
            vuln_id: str):
        super().__init__("PUT", api_key, json=vulnerability_recheck.model_dump())
        self.url = f"{BASE_URL}/scans/{scan_id}/results/{result_id}/vulnerabilities/{vuln_id}/recheck"