from base import BASE_URL
from .api_vulnerabilities_mixin import ApiVulnerabilitiesMixin
from results.utils import VulnerabilityStatus


class ApiVulnerabilitiesSetStatus(ApiVulnerabilitiesMixin):


    def __init__(self, api_key: str, vuln_id: str, vulnerabilities_status: VulnerabilityStatus):
        super().__init__("PUT", api_key, json=vulnerabilities_status.model_dump())
        self.url = f"{BASE_URL}/vulnerabilities/{vuln_id}/status"