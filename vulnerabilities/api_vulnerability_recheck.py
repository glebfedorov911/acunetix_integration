from base import BASE_URL
from .api_vulnerabilities_mixin import ApiVulnerabilitiesMixin
from results.utils import VulnerabilityRecheck


class ApiVulnerabilityRecheck(ApiVulnerabilitiesMixin):


    def __init__(self, api_key: str, vuln_id: str, vulnerability_recheck: VulnerabilityRecheck):
        super().__init__("PUT", api_key, json=vulnerability_recheck.model_dump())
        self.url = f"{BASE_URL}/vulnerabilities/{vuln_id}/recheck"